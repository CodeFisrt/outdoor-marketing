<div class="loading-container" *ngIf="loading">
  <div class="spinner"></div>
  <p>Loading Details...</p>
</div>

<!-- ‚úÖ A. BOARD DETAILS VIEW -->
<div class="full-page-container" *ngIf="!loading && board">
  <!-- Premium Card Container -->
  <div class="premium-details-card" *ngIf="currentSection === 'details'">

    <!-- Close/Back Button -->
    <!-- <button class="close-btn" (click)="goBack()">‚úñ</button> -->
    <button class="back-btn" (click)="goBack()">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M19 12H5M12 19l-7-7 7-7" />
      </svg>
      Back
    </button>

    <div class="card-layout">

      <!-- Left Side: Hero Image -->
      <div class="image-section">
        <div class="image-wrapper">
          <img [src]="board.image" [alt]="board.hoardingType" class="hero-image"
            (error)="board.image = 'assets/billboardimg.jpg'">
          <div class="status-badge"
            [ngClass]="board.availability === 'Available' ? 'status-available' : 'status-booked'">
            {{ board.availability }}
          </div>
        </div>
      </div>

      <!-- Right Side: Content & Details -->
      <div class="content-section">

        <div class="header-info">
          <div class="service-tag">{{ board.district }}</div>
          <h1 class="main-title">{{ board.hoardingType }}</h1>
          <p class="location-sub">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
              <circle cx="12" cy="10" r="3"></circle>
            </svg>
            {{ board.location }}
          </p>
        </div>

        <div class="price-box">
          <span class="price-label">Price per unit</span>
          <span class="price-val">‚Çπ {{ board.price }}</span>
        </div>

        <!-- Dynamic Grid Attributes -->
        <div class="attributes-grid">
          <div class="attr-item" *ngFor="let attr of board.attributes">
            <span class="attr-label">{{ attr.label }}</span>
            <span class="attr-val">{{ attr.value }}</span>
          </div>
          <!-- Always show Contact if available -->
          <div class="attr-item" *ngIf="board.contactName">
            <span class="attr-label">Contact Person</span>
            <span class="attr-val">{{ board.contactName }}</span>
          </div>
          <div class="attr-item" *ngIf="board.contactNum">
            <span class="attr-label">Phone</span>
            <span class="attr-val">{{ board.contactNum }}</span>
          </div>
        </div>

        <div class="description-box">
          <h3>Description</h3>
          <p>{{ board.description || 'No description available for this service.' }}</p>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
          <button class="btn-premium btn-book" *ngIf="board.availability === 'Available'" (click)="showSection('book')">
            Book Now
          </button>
          <button class="btn-premium btn-schedule"
            *ngIf="board.availability === 'Available' || board.availability === 'Booked'"
            (click)="showSection('schedule')">
            Schedule Visit
          </button>
          <button class="btn-premium btn-bid" (click)="showSection('bidding')">
            Place Bid
          </button>
        </div>

      </div>
    </div>
  </div>

  <!-- SUB SECTIONS (Retained structure but wrapped nicely) -->

  <!-- BOOK NOW SECTION -->
  <div *ngIf="currentSection === 'book'" class="sub-section-container">
    <button class="back-link" (click)="showSection('details')">‚Üê Back to Details</button>
    <div class="form-card">
      <h3>üìå Book this Service</h3>

      <!-- Personal Details -->
      <div class="form-group">
        <label>Full Name</label>
        <input type="text" [(ngModel)]="bookingDetails.fullName" placeholder="Enter your full name">
      </div>

      <div class="row-inputs">
        <div class="form-group">
          <label>Email Address</label>
          <input type="email" [(ngModel)]="bookingDetails.email" placeholder="name@example.com">
        </div>
        <div class="form-group">
          <label>Contact Number</label>
          <input type="tel" [(ngModel)]="bookingDetails.phone" placeholder="+91 XXXXX XXXXX" maxlength="10">
        </div>
      </div>

      <!-- Design Options -->
      <div class="form-group">
        <label>Do you have the design/creative ready?</label>
        <div class="modern-select-wrapper">
          <select [(ngModel)]="bookingDetails.designReady" class="custom-dropdown">
            <option value="Yes">Yes, I have the design</option>
            <option value="No">No, I don't have it</option>
          </select>
        </div>
      </div>

      <div class="form-group" *ngIf="bookingDetails.designReady === 'No'">
        <label>Do you want our design team to create the design?</label>
        <div class="modern-select-wrapper">
          <select [(ngModel)]="bookingDetails.needDesignService" class="custom-dropdown">
            <option value="Yes">Yes, please design it for me</option>
            <option value="No">No, I will arrange it myself</option>
          </select>
        </div>
      </div>

      <!-- Dates -->
      <div class="row-inputs">
        <div class="form-group">
          <label>Start Date</label>
          <input type="date" [(ngModel)]="bookingDetails.startDate" [min]="minDate">
        </div>
        <div class="form-group">
          <label>End Date</label>
          <input type="date" [(ngModel)]="bookingDetails.endDate" [min]="minDate">
        </div>
      </div>

      <!-- Payment -->
      <div class="form-group">
        <label>Payment Completed?</label>
        <div class="modern-select-wrapper">
          <select [(ngModel)]="bookingDetails.paymentCompleted" class="custom-dropdown">
            <option value="Yes">Yes, Payment Done</option>
            <option value="No">No, Payment Pending</option>
          </select>
        </div>
        <p class="error-text" *ngIf="bookingDetails.paymentCompleted === 'No'">
          ‚ö†Ô∏è Please complete the payment to proceed.
        </p>
      </div>

      <!-- Repeat Service -->
      <div class="form-group">
        <label>Are you looking to book the same service again?</label>
        <div class="modern-select-wrapper">
          <select [(ngModel)]="bookingDetails.repeatService" class="custom-dropdown">
            <option value="Yes">Yes, Interested</option>
            <option value="No">No, Just this time</option>
          </select>
        </div>
      </div>

      <!-- Terms -->
      <div class="form-group checkbox-group">
        <label class="checkbox-container">
          <input type="checkbox" [(ngModel)]="bookingDetails.agreedToTerms">
          <span class="checkmark"></span>
          I have read and agree to the terms and conditions.
        </label>
      </div>

      <button class="btn-primary-action" (click)="submitBooking()"
        [disabled]="bookingDetails.paymentCompleted === 'No' || !bookingDetails.agreedToTerms"
        [ngClass]="{'disabled-btn': bookingDetails.paymentCompleted === 'No' || !bookingDetails.agreedToTerms}">
        Confirm Booking
      </button>
    </div>
  </div>

  <!-- SCHEDULE SECTION -->
  <div *ngIf="currentSection === 'schedule'" class="sub-section-container">
    <button class="back-link" (click)="showSection('details')">‚Üê Back to Details</button>
    <div class="form-card">
      <h3>‚è≥ Schedule a Visit</h3>
      <div class="form-group">
        <label>Select Date</label>
        <input type="date">
      </div>
      <div class="form-group">
        <label>Time Slot</label>
        <select>
          <option>10:00 AM - 01:00 PM</option>
          <option>02:00 PM - 05:00 PM</option>
        </select>
      </div>
      <button class="btn-primary-action btn-sched">Confirm Schedule</button>
    </div>
  </div>

  <!-- BIDDING SECTION -->
  <div *ngIf="currentSection === 'bidding'" class="sub-section-container">
    <button class="back-link" (click)="showSection('details')">‚Üê Back to Details</button>
    <div class="form-card">
      <h3>üí∞ Place Your Bid</h3>
      <p class="bid-info">Current Price: <strong>‚Çπ {{ board.price }}</strong></p>
      <div class="form-group">
        <label>Your Bid Amount</label>
        <input type="number" placeholder="Enter amount">
      </div>
      <div class="form-group">
        <label>Message (Optional)</label>
        <textarea rows="3"></textarea>
      </div>
      <button class="btn-primary-action btn-bid">Submit Bid</button>
    </div>
  </div>

</div>